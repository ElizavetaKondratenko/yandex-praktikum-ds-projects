# Прогнозирование количества заказов такси на следующий час
Код проекта - [ipynb][1]. Html версия - [html][2].

[1]: https://github.com/ElizavetaKondratenko/yandex-praktikum-ds-projects/blob/main/12-%D0%BF%D1%80%D0%BE%D0%B3%D0%BD%D0%BE%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BA%D0%BE%D0%BB%D0%B8%D1%87%D0%B5%D1%81%D1%82%D0%B2%D0%B0-%D0%B7%D0%B0%D0%BA%D0%B0%D0%B7%D0%BE%D0%B2-%D1%82%D0%B0%D0%BA%D1%81%D0%B8-%D0%BD%D0%B0-%D1%81%D0%BB%D0%B5%D0%B4%D1%83%D1%8E%D1%89%D0%B8%D0%B9-%D1%87%D0%B0%D1%81/P12-predicting-taxi-trips.ipynb
[2]: https://github.com/ElizavetaKondratenko/yandex-praktikum-ds-projects/blob/main/12-%D0%BF%D1%80%D0%BE%D0%B3%D0%BD%D0%BE%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BA%D0%BE%D0%BB%D0%B8%D1%87%D0%B5%D1%81%D1%82%D0%B2%D0%B0-%D0%B7%D0%B0%D0%BA%D0%B0%D0%B7%D0%BE%D0%B2-%D1%82%D0%B0%D0%BA%D1%81%D0%B8-%D0%BD%D0%B0-%D1%81%D0%BB%D0%B5%D0%B4%D1%83%D1%8E%D1%89%D0%B8%D0%B9-%D1%87%D0%B0%D1%81/P12-predicting-taxi-trips.html

## Основная задача

Разработка системы предсказания объема заказа. 

## Описание проекта

**Заказчик** - компания «Чётенькое такси». Для привлечения большего числа водителей в периоды пиковой нагрузки, им необходима модель, способная прогнозировать количество заказов такси на следующий час.

**Исходные данные** - исторические данные о заказах такси в аэропорт.

Необходимо, чтобы значение метрики качества RMSE на тестовой выборке не превышало 48.

## Сферы деятельности

* Бизнес
* Интернет-сервисы
* Стартапы

## Основные инструменты

- **python**
- **pandas**
- **numpy**
- **matplotlib**
- statsmodels.tsa.seasonal.**seasonal_decompose**
- sklearn.model_selection.**TimeSeriesSplit**
- sklearn.linear_model.**LinearRegression**
- lightgbm.**LGBMRegressor**

## Выводы

Перед нами стояла задача создания модели машинного обучения, которая смогла бы предсказывать отток клиентов с целью его предотвращения. Исходно мы работали с 5 наборами данных, в которых содержались персональные данные клиентов, информация об их договорах и используемых услугах.

На этапе предобработки мы подготовили данные к дальнейшему анализу и моделированию: объединили исходные датафреймы в одни и заполнили образовавшиеся пропуски, создали дополнительные переменные и частично преобразовали имеющиеся.

На этапе исследовательского анализа мы более подробно изучили наши данные. В значениях таргета был обнаружен существенный дисбаланс, которые мы позднее учли при разбиении данных, а также на этапе моделирования. Также мы рассмотрели на распределение двух групп клиентов в рамках каждой из переменных: между разными группами для категориальных переменных и разницу медиан для непрерывных. Для каждой из переменных были сделаны соответствующие выводы о распределении групп. Наконец, мы оценили корреляцию между всеми нашими признаками. Это позволило предположить, какие именно переменные окажутся наиболее значимыми на этапе моделирования.

Наконец, на этапе моделирования мы вначале вновь занялись подготовкой данных: разбили данные на две выборки и провели кодирование части переменных. После мы подобрали наиболее оптимальные параметры для 5 моделей с целью максимизации ключевого параметра Roc-Auc. Мы рассмотрели следующие модели: модель k-ближайщих соседей, случайный лес, LightGBM, модель CatBoost и XGBoost. Лучшие результаты показали две последние модели - разрыв в значениях параметра качества был минимален. Для определения итоговой модели мы провели дополнительный тест - оценили качество двух моделей по второму критерию значимости accuracy. Значительный перевес в значении оказался у модели XGBoost. Именно ее мы выбрали в качестве итоговой модели.
