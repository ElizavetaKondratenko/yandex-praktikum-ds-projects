# Исследование технологического процесса очистки золота
Код проекта - [ipynb][1]. Html версия - [html][2].

[1]: https://github.com/ElizavetaKondratenko/yandex-praktikum-ds-projects/blob/main/09-%D0%B8%D1%81%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B3%D0%BE-%D0%BF%D1%80%D0%BE%D1%86%D0%B5%D1%81%D1%81%D0%B0-%D0%BE%D1%87%D0%B8%D1%81%D1%82%D0%BA%D0%B8-%D0%B7%D0%BE%D0%BB%D0%BE%D1%82%D0%B0/P9-machine-learning-model-for-a-metalworking-enterprise.ipynb
[2]: https://github.com/ElizavetaKondratenko/yandex-praktikum-ds-projects/blob/main/09-%D0%B8%D1%81%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B3%D0%BE-%D0%BF%D1%80%D0%BE%D1%86%D0%B5%D1%81%D1%81%D0%B0-%D0%BE%D1%87%D0%B8%D1%81%D1%82%D0%BA%D0%B8-%D0%B7%D0%BE%D0%BB%D0%BE%D1%82%D0%B0/P9-machine-learning-model-for-a-metalworking-enterprise.html

## Основная задача

Спрогнозировать концентрацию золота при проведении процесса очистки золота.

## Описание проекта

**Заказчик** - компания «Цифры», разрабатывающая решения для эффективной работы промышленных предприятий.

Необходимо разработать прототип модели машинного обучения, которая будет помогать оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками. Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды.

**Исходные данные** - данные с параметрами добычи и очистки.

Данные индексируются датой и временем получения информации (признак date). Соседние по времени параметры часто похожи. Некоторые параметры недоступны, потому что замеряются и/или рассчитываются значительно позже. Из-за этого в тестовой выборке отсутствуют некоторые признаки, которые могут быть в обучающей.

## Сферы деятельности

* Индустриальные компании
* Стартапы
* Обработка

## Основные инструменты

- **python**
- **pandas**
- **numpy**
- **seaborn**
- **matplotlib**
- sklearn.model_selection.**RandomizedSearchCV**
- sklearn.ensemble.**RandomForestClassifier**
- sklearn.linear_model.**LinearRegression**
- catboost.**CatBoostClassifier**

## Выводы

Итак, перед нами стояла задача разработки прототипа модели машинного обучения, которая будет помогать оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками. Достичь мы это должны были путем предсказывания коэффициента восстановления золота из золотосодержащей руды.

На вход мы получили три набора данных - тренировочный, тестовый и полный. Полный набор состоял из объединения тренировочного и более расширенного тестового набора. Первичный анализ данных показал, что в данных присутствуют наблюдения с пропущенными значениями - мы заполнили их основываясь на информации о наблюдение, идущем перед наблюдением с пропуском. Мы выбрали такой метод, поскольку нам было сказано, что данные отсортированы по времени и стоящие рядом наблюдения в целом похожи.

Нами также был проведен выборочный детальный анализ некоторых характеристик. В ходе такого анализа удалось выявить следующие закономерности. Доля серебра от общего сырья сокращается от этапа к этапу, в то время как доля свинца, напротив, растет. Доля золота также увеличивается с каждым этапом. Возможно, проводимых отчисток недостаточно, чтобы вычленить свинец из исходного сырья и необходимо проводить дополнительное очищение. Доля золота также увеличивается на каждом этапе, что, учитывая специфику деятельности компании, довольно логично.

Распределение размеров гранул сырья на тестовой и тренировочной выборках оказались похожи, что позволило нам спокойно построить общие для двух выборок модели. Наконец, было обнаружено, что суммарная концентрация рассматриваемых веществ может достигать нуля. От таких наблюдений было решено избавиться.

Наконец, нами были построены три типа моделей для прогнозирования коэффициента эффективности после флотации и вторичной отчистки. Для выбора лучшей модели использовался суммарный коэффициент sMAPE. По итогу, лучшее качество показала модель случайного леса. Именно ее мы выбрали в качестве итоговой.

Несмотря на то, что sMAPE, полученный как на тестовой, так и на тренировочной выборке, был не слишком высок, разработанной нами модели оказалось недостаточно для того, чтобы побить качество простейшей дамми регрессии, использующей медианное значение в качестве предсказателя.
