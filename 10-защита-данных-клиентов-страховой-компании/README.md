# Защита данных клиентов страховой компании
Код проекта - [ipynb][1]. Html версия - [html][2].

[1]: https://github.com/ElizavetaKondratenko/yandex-praktikum-ds-projects/blob/main/16-%D0%BA%D0%BB%D0%B0%D1%81%D1%81%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F-%D0%BA%D0%BB%D0%B8%D0%B5%D0%BD%D1%82%D0%BE%D0%B2-%D1%82%D0%B5%D0%BB%D0%B5%D0%BA%D0%BE%D0%BC-%D0%BA%D0%BE%D0%BC%D0%BF%D0%B0%D0%BD%D0%B8%D0%B8/P16-telecom.ipynb
[2]: https://github.com/ElizavetaKondratenko/yandex-praktikum-ds-projects/blob/main/16-%D0%BA%D0%BB%D0%B0%D1%81%D1%81%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F-%D0%BA%D0%BB%D0%B8%D0%B5%D0%BD%D1%82%D0%BE%D0%B2-%D1%82%D0%B5%D0%BB%D0%B5%D0%BA%D0%BE%D0%BC-%D0%BA%D0%BE%D0%BC%D0%BF%D0%B0%D0%BD%D0%B8%D0%B8/P16-telecom.html

## Основная задача

Классификация клиентов на ушедших и оставшихся с целью дальнейшего предотвращения оттока клиентов. 

## Описание проекта

**Заказчик** - оператор связи «Ниединогоразрыва.ком». Он планирует запустить программу, которая будет предлагать промокоды и специальные услуги тем клиентам, которые планируют уйти. Для этого им необходима модель, которая сможет прогнозировать отток клиентов.

**Исходные данные** - обезличенные данные о некоторых клиентах, информацию об их тарифах и договорах.

Оператор предоставляет два основных типа услуг:
- Стационарную телефонную связь с дополнительной возможностью подключения телефонного аппарата к нескольким линиям одновременно.
- Интернет. Подключение может быть двух типов: через телефонную линию (DSL, «цифровая абонентская линия») или оптоволоконный кабель (Fiber optic).

Также доступны такие услуги:
- Интернет-безопасность: антивирус (DeviceProtection) и блокировка небезопасных сайтов (OnlineSecurity);
- Выделенная линия технической поддержки (TechSupport);
- Облачное хранилище файлов для резервного копирования данных (OnlineBackup);
- Стриминговое телевидение (StreamingTV) и каталог фильмов (StreamingMovies).
- За услуги клиенты могут платить каждый месяц или заключить договор на 1–2 года. Доступны различные способы расчёта и возможность получения электронного чека.

Информация о договорах актуальна на 1 февраля 2020.

## Сферы деятельности

* Банковская сфера
* Информационная безопасность
* Интернет-сервисы
* Инвестиции
* Телеком

## Основные инструменты

- **python**
- **pandas**
- **numpy**
- **seaborn**
- **matplotlib**
- phik.report.**plot_correlation_matrix**
- sklearn.preprocessing.**OneHotEncoder**
- sklearn.model_selection.**GridSearchCV**
- sklearn.ensemble.**RandomForestClassifier**
- sklearn.neighbors.**KNeighborsClassifier**
- catboost.**CatBoostClassifier**
- lightgbm.**LGBMClassifier**
- xgboost.**XGBClassifier**

## Выводы

Перед нами стояла задача создания модели машинного обучения, которая смогла бы предсказывать отток клиентов с целью его предотвращения. Исходно мы работали с 5 наборами данных, в которых содержались персональные данные клиентов, информация об их договорах и используемых услугах.

На этапе предобработки мы подготовили данные к дальнейшему анализу и моделированию: объединили исходные датафреймы в одни и заполнили образовавшиеся пропуски, создали дополнительные переменные и частично преобразовали имеющиеся.

На этапе исследовательского анализа мы более подробно изучили наши данные. В значениях таргета был обнаружен существенный дисбаланс, которые мы позднее учли при разбиении данных, а также на этапе моделирования. Также мы рассмотрели на распределение двух групп клиентов в рамках каждой из переменных: между разными группами для категориальных переменных и разницу медиан для непрерывных. Для каждой из переменных были сделаны соответствующие выводы о распределении групп. Наконец, мы оценили корреляцию между всеми нашими признаками. Это позволило предположить, какие именно переменные окажутся наиболее значимыми на этапе моделирования.

Наконец, на этапе моделирования мы вначале вновь занялись подготовкой данных: разбили данные на две выборки и провели кодирование части переменных. После мы подобрали наиболее оптимальные параметры для 5 моделей с целью максимизации ключевого параметра Roc-Auc. Мы рассмотрели следующие модели: модель k-ближайщих соседей, случайный лес, LightGBM, модель CatBoost и XGBoost. Лучшие результаты показали две последние модели - разрыв в значениях параметра качества был минимален. Для определения итоговой модели мы провели дополнительный тест - оценили качество двух моделей по второму критерию значимости accuracy. Значительный перевес в значении оказался у модели XGBoost. Именно ее мы выбрали в качестве итоговой модели.
